<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin FSR | Gestão de Pacotes</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; color: #333; margin: 0; padding: 20px; }
        .container { max-width: 1300px; margin: auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); }
        h1 { color: #0056b3; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-bottom: 20px; }
        .btn { padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-block; font-size: 14px; margin-right: 5px; transition: background-color 0.3s; }
        .btn-primary { background-color: #0056b3; color: white; }
        .btn-primary:hover { background-color: #004481; }
        .btn-success { background-color: #28a745; color: white; }
        .btn-success:hover { background-color: #218838; }
        .btn-danger { background-color: #dc3545; color: white; }
        .btn-danger:hover { background-color: #c82333; }
        .btn-warning { background-color: #ffc107; color: #333; }
        .btn-warning:hover { background-color: #e0a800; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px 15px; border: 1px solid #ddd; text-align: left; font-size: 14px; vertical-align: middle; }
        th { background-color: #f8f8f8; font-weight: 600; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .status-badge { padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 0.9em; }
        .status-ativo { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .status-inativo { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .img-thumb { width: 50px; height: 30px; object-fit: cover; border-radius: 3px; }
        .pacote-consultoria { background-color: #fff3cd; color: #856404; font-style: italic; }
        .pacote-consultoria .btn-danger { display: none; } /* Não permite excluir consultoria */
    </style>
</head>
<body>
    <div class="container">
        <h1><i class="fas fa-list-alt"></i> Gestão de Pacotes de Viagem</h1>
        <p>Gerencie as ofertas que aparecem na página principal (pacotes ativos e ordenados).</p>

        <a href="{{ url_for('admin_pacotes_form') }}" class="btn btn-success" style="margin-bottom: 20px;">
            <i class="fas fa-plus"></i> Novo Pacote
        </a>
        
        <a href="{{ url_for('leads') }}" class="btn btn-primary" style="margin-bottom: 20px; float: right;">
            <i class="fas fa-users"></i> Ver Leads
        </a>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Ordem</th>
                    <th>Nome do Pacote</th>
                    <th>Preço Atual (10x)</th>
                    <th>Total (À Vista)</th>
                    <th>Tipo/Saída</th>
                    <th>Status</th>
                    <th style="width: 200px;">Ações</th>
                </tr>
            </thead>
            <tbody>
                {% for pacote in pacotes %}
                <tr class="{% if pacote.tipo == 'CONSULTORIA' %}pacote-consultoria{% endif %}">
                    <td>{{ pacote.id }}</td>
                    <td>{{ pacote.ordem if pacote.ordem else '99' }}</td>
                    <td>
                        <strong>{{ pacote.nome }}</strong>
                        <div style="font-size: 0.8em; color: #777;">{{ pacote.desc[:50] }}...</div>
                    </td>
                    <td>R$ {{ pacote.preco_atual if pacote.preco_atual else '-' }}</td>
                    <td>R$ {{ pacote.preco_antigo if pacote.preco_antigo else '-' }}</td>
                    <td>
                        <span style="font-weight: bold;">{{ pacote.tipo }}</span><br>
                        <span style="font-size: 0.9em;">Saída: {{ pacote.saida }}</span>
                    </td>
                    <td>
                        {% if pacote.ativo %}
                            <span class="status-badge status-ativo"><i class="fas fa-check-circle"></i> Ativo</span>
                        {% else %}
                            <span class="status-badge status-inativo"><i class="fas fa-times-circle"></i> Inativo</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ url_for('admin_pacotes_editar', pacote_id=pacote.id) }}" class="btn btn-warning">
                            <i class="fas fa-edit"></i> Editar
                        </a>
                        
                        {% if pacote.tipo != 'CONSULTORIA' %}
                        <form action="{{ url_for('admin_pacotes_excluir', pacote_id=pacote.id) }}" method="POST" style="display: inline;" onsubmit="return confirm('Tem certeza que deseja EXCLUIR o pacote: {{ pacote.nome }}? Esta ação é irreversível.');">
                            <button type="submit" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Excluir</button>
                        </form>
                        {% endif %}
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="8" style="text-align: center;">Nenhum pacote cadastrado. <a href="{{ url_for('admin_pacotes_form') }}">Clique aqui para criar um novo.</a></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <div style="margin-top: 30px; padding: 15px; background: #f0f0f0; border-radius: 5px;">
            <p><strong>Instruções:</strong></p>
            <ul>
                <li>Pacotes Ativos (`Ativo`) aparecem na Landing Page, ordenados pelo campo `Ordem`.</li>
                <li>O campo `Ordem` deve ser um número baixo (ex: 1, 2, 3) para aparecer no início.</li>
                <li>Apenas os 5 primeiros pacotes Ativos + o card de Consultoria aparecerão na Vitrine principal.</li>
            </ul>
        </div>
    </div>
</body>
</html>